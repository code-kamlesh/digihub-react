{"ast":null,"code":"var _jsxFileName = \"D:\\\\Tata_Strive\\\\WebApplication\\\\digiHub\\\\trunk\\\\digiHubWeb\\\\src\\\\layouts\\\\Dashboard.js\";\nimport React, { Component, useEffect, useState } from 'react';\nimport { Switch, Route, Redirect } from \"react-router-dom\";\nimport './../App.css';\nimport './../assets/css/login-style.css';\nimport './../assets/css/font-awesome.min.css'; // @material-ui/core components\n\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport PerfectScrollbar from \"perfect-scrollbar\";\nimport \"perfect-scrollbar/css/perfect-scrollbar.css\"; //import styles from \"./adminStyle.js\";\n\nimport styles from \"./adminStyle.js\";\nimport Navbar from \"./../components/Navbars/Navbar.js\";\nimport Sidebar from \"./../components/Sidebar/Sidebar.js\";\nimport Footer from \"./../components/Footer/Footer.js\";\nimport UserContext from './../components/GolbalContext';\nimport logo from \"./../assets/images/tatastrivelogo.png\";\nimport stanadrdroutes from \"./../routes.js\";\nimport principalroutes from \"./../routes/principalroutes.js\";\nimport changeleaderroutes from \"./../routes/changeleaderroutes.js\";\nimport assessorRoutes from \"./../routes/assessorRoutes.js\";\nimport nanoUniconRoutes from \"./../routes/nanoUniconRoutes.js\";\nimport corporateAdminRoutes from \"./../routes/corporateAdminRoutes\";\nimport { isSessionValid, clearAppData } from './../util/session.js';\nimport ContactUs from \"./../components/Footer/ContactUs.js\";\nimport Disclaimer from \"./../components/Footer/Disclaimer.js\";\nimport PrivacyPolicy from \"./../components/Footer/PrivacyPolicy.js\";\nimport ReactGA from 'react-ga';\nimport centerOpsRoutes from \"./../routes/centerOpsRoutes.js\";\nimport mobilizerRoutes from \"./../routes/mobilizer.js\";\nimport funderRoutes from \"./../routes/funderroutes.js\";\nimport changePasswordRoutes from \"./../routes/changePasswordRoutes.js\";\nimport { fetchUserDetails } from \"./../util/api.js\";\nconst useStyles = makeStyles(styles);\nlet ps;\nexport default function Admin({ ...rest\n}) {\n  ReactGA.initialize(process.env.REACT_APP_GOOGLE_ANALYTICS_ID);\n  ReactGA.set({\n    userId: UserContext.userid // any data that is relevant to the user session\n    // that you would like to track with google analytics\n\n  });\n  ReactGA.pageview(window.location.pathname + window.location.search);\n  const [routes, setRoutes] = useState(stanadrdroutes);\n  const [loaded, setLoaded] = useState(true);\n\n  const sessionValidity = props => {\n    isSessionValid();\n  };\n\n  sessionValidity();\n\n  const validateUserLastLoginDate = () => {\n    fetchUserDetails(UserContext.userid).then(userDetailsJsonData => {\n      console.log(userDetailsJsonData);\n      let res = JSON.parse(userDetailsJsonData.data);\n      console.log(\"data>>>>>>>>\", res);\n      let preDate = res[0].passwordChangedDate;\n      console.log(typeof preDate);\n      let date1 = new Date(preDate);\n      console.log(date1);\n      let today = new Date(); // console.log(today)\n\n      const datediff = Math.floor((Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()) - Date.UTC(date1.getFullYear(), date1.getMonth(), date1.getDate())) / (1000 * 60 * 60 * 24));\n      console.log(\">>>>>>>>>>>>>>\", datediff);\n      UserContext.lastPassowrdChangeDiff = datediff;\n\n      if (datediff >= 90) {\n        setRoutes(changePasswordRoutes);\n        setLoaded(false);\n      }\n    });\n  }; // (()=>{\n  //   fetchUserDetails(UserContext.userid).then((userDetailsJsonData)=>{\n  //     let res = JSON.parse(userDetailsJsonData.data)\n  //     let preDate = res[0].passwordChangedDate\n  //     console.log(typeof preDate)\n  //     let date1= new Date(preDate)\n  //     console.log(date1)\n  //     let today = new Date();\n  //     // console.log(today)\n  //     const datediff = Math.floor((Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()) - Date.UTC(date1.getFullYear(), date1.getMonth(), date1.getDate()) ) /(1000 * 60 * 60 * 24));\n  //     console.log(\">>>>>>>>>>>>>>\",datediff)\n  //     UserContext.lastPassowrdChangeDiff = datediff;\n  //     if(datediff>=90){\n  //       // setRoutes()\n  //       // history.push('/dashboard/changepassword')\n  //       // <ChangePassword />\n  //       setRoutes(changePasswordRoutes);\n  //       setLoaded(false);\n  //     }\n  //     })\n  // })()\n\n\n  if (UserContext.roleid === 3 && (loaded || UserContext.defaultRoleId)) {\n    UserContext.defaultRoleId = \"\";\n    setRoutes(principalroutes);\n    setLoaded(false);\n  } else if (UserContext.roleName === 'Change leader/Facilitator' && (loaded || UserContext.defaultRoleId)) {\n    UserContext.defaultRoleId = \"\";\n    setRoutes(changeleaderroutes);\n    setLoaded(false);\n  } else if (UserContext.roleName === 'Center Manager' && (loaded || UserContext.defaultRoleId)) {\n    // defaultProgramId check is NOT required , hence commeted by Murali on 2nd Nov 2021\n    // And also there is no accessor role, this role will be carried by Center Managers only\n    if (UserContext.defaultProgramId == 1 || UserContext.defaultProgramId == 9) {\n      validateUserLastLoginDate();\n      UserContext.defaultRoleId = \"\";\n      setRoutes(nanoUniconRoutes);\n      setLoaded(false);\n    } else {\n      validateUserLastLoginDate();\n      UserContext.defaultRoleId = \"\";\n      setRoutes(assessorRoutes);\n      setLoaded(false);\n    }\n  } else if (UserContext.roleName === 'Corporate Admin' && (loaded || UserContext.defaultRoleId)) {\n    validateUserLastLoginDate();\n    UserContext.defaultRoleId = \"\";\n    setRoutes(corporateAdminRoutes);\n    setLoaded(false);\n  } else if (UserContext.roleName === 'Center Ops' && (loaded || UserContext.defaultRoleId)) {\n    validateUserLastLoginDate();\n    UserContext.defaultRoleId = \"\";\n    setRoutes(centerOpsRoutes);\n    setLoaded(false);\n  } else if (UserContext.roleid === 19 && (loaded || UserContext.defaultRoleId)) {\n    UserContext.defaultRoleId = \"\";\n    setRoutes(mobilizerRoutes);\n    setLoaded(false);\n  } else if (UserContext.roleid === 10 && (loaded || UserContext.defaultRoleId)) {\n    UserContext.defaultRoleId = \"\";\n    setRoutes(funderRoutes);\n    setLoaded(false);\n  }\n\n  let displayRoutes1 = [];\n  let count = 0;\n  let displayRoutes = routes.map(prop => {\n    if (prop.status) {\n      displayRoutes1[count] = prop;\n      count++;\n    }\n  });\n  let switchRoutes = /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 7\n    }\n  }, routes.map((prop, key) => {\n    if (prop.layout === \"/dashboard\") {\n      return /*#__PURE__*/React.createElement(Route, {\n        path: prop.layout + prop.path,\n        component: prop.component,\n        key: key,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 15\n        }\n      });\n    }\n\n    return null;\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/dashboard/ContactUs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(ContactUs, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Route, {\n    path: \"/dashboard/Disclaimer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Disclaimer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Route, {\n    path: \"/dashboard/privacypolicy\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(PrivacyPolicy, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Redirect, {\n    from: \"/dashboard\",\n    to: \"/dashboard/dashboard\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 9\n    }\n  })); // styles\n\n  const classes = useStyles(); // ref to help us initialize PerfectScrollbar on windows devices\n\n  const mainPanel = React.createRef(); // states and functions\n\n  const [fixedClasses, setFixedClasses] = React.useState(\"dropdown show\");\n  const [mobileOpen, setMobileOpen] = React.useState(false);\n\n  const handleDrawerToggle = () => {\n    setMobileOpen(!mobileOpen);\n  };\n\n  const getRoute = () => {\n    return window.location.pathname !== \"/admin/maps\";\n  };\n\n  const resizeFunction = () => {\n    if (window.innerWidth >= 960) {\n      setMobileOpen(false);\n    }\n  }; // initialize and destroy the PerfectScrollbar plugin\n\n\n  React.useEffect(() => {\n    if (navigator.platform.indexOf(\"Win\") > -1) {\n      ps = new PerfectScrollbar(mainPanel.current, {\n        suppressScrollX: true,\n        suppressScrollY: false\n      });\n      document.body.style.overflow = \"hidden\";\n    }\n\n    window.addEventListener(\"resize\", resizeFunction); // Specify how to clean up after this effect:\n\n    return function cleanup() {\n      if (navigator.platform.indexOf(\"Win\") > -1) {\n        ps.destroy();\n      }\n\n      window.removeEventListener(\"resize\", resizeFunction);\n    };\n  }, [mainPanel]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.wrapper,\n    id: \"popupContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Sidebar, Object.assign({\n    handleDrawerToggle: handleDrawerToggle,\n    logo: logo,\n    logoText: \"\",\n    routes: displayRoutes1,\n    open: mobileOpen\n  }, rest, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.mainPanel,\n    ref: mainPanel,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Navbar, Object.assign({\n    routes: routes,\n    handleDrawerToggle: handleDrawerToggle\n  }, rest, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.content,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 21\n    }\n  }, switchRoutes)), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 17\n    }\n  })));\n}","map":{"version":3,"sources":["D:/Tata_Strive/WebApplication/digiHub/trunk/digiHubWeb/src/layouts/Dashboard.js"],"names":["React","Component","useEffect","useState","Switch","Route","Redirect","makeStyles","PerfectScrollbar","styles","Navbar","Sidebar","Footer","UserContext","logo","stanadrdroutes","principalroutes","changeleaderroutes","assessorRoutes","nanoUniconRoutes","corporateAdminRoutes","isSessionValid","clearAppData","ContactUs","Disclaimer","PrivacyPolicy","ReactGA","centerOpsRoutes","mobilizerRoutes","funderRoutes","changePasswordRoutes","fetchUserDetails","useStyles","ps","Admin","rest","initialize","process","env","REACT_APP_GOOGLE_ANALYTICS_ID","set","userId","userid","pageview","window","location","pathname","search","routes","setRoutes","loaded","setLoaded","sessionValidity","props","validateUserLastLoginDate","then","userDetailsJsonData","console","log","res","JSON","parse","data","preDate","passwordChangedDate","date1","Date","today","datediff","Math","floor","UTC","getFullYear","getMonth","getDate","lastPassowrdChangeDiff","roleid","defaultRoleId","roleName","defaultProgramId","displayRoutes1","count","displayRoutes","map","prop","status","switchRoutes","key","layout","path","component","classes","mainPanel","createRef","fixedClasses","setFixedClasses","mobileOpen","setMobileOpen","handleDrawerToggle","getRoute","resizeFunction","innerWidth","navigator","platform","indexOf","current","suppressScrollX","suppressScrollY","document","body","style","overflow","addEventListener","cleanup","destroy","removeEventListener","wrapper","content","container"],"mappings":"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","sourcesContent":["import React, { Component,useEffect, useState } from 'react';\r\n\r\nimport { Switch, Route, Redirect } from \"react-router-dom\";\r\nimport './../App.css';\r\nimport './../assets/css/login-style.css'\r\nimport './../assets/css/font-awesome.min.css'\r\n// @material-ui/core components\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\n\r\nimport PerfectScrollbar from \"perfect-scrollbar\";\r\nimport \"perfect-scrollbar/css/perfect-scrollbar.css\";\r\n\r\n//import styles from \"./adminStyle.js\";\r\nimport styles from \"./adminStyle.js\";\r\nimport Navbar from \"./../components/Navbars/Navbar.js\";\r\nimport Sidebar from \"./../components/Sidebar/Sidebar.js\";\r\nimport Footer from \"./../components/Footer/Footer.js\";\r\nimport UserContext from './../components/GolbalContext'\r\n\r\nimport logo from \"./../assets/images/tatastrivelogo.png\";\r\nimport stanadrdroutes from \"./../routes.js\";\r\nimport principalroutes from \"./../routes/principalroutes.js\";\r\nimport changeleaderroutes from \"./../routes/changeleaderroutes.js\";\r\nimport assessorRoutes from \"./../routes/assessorRoutes.js\";\r\nimport nanoUniconRoutes from \"./../routes/nanoUniconRoutes.js\";\r\nimport corporateAdminRoutes from \"./../routes/corporateAdminRoutes\";\r\nimport {isSessionValid,clearAppData} from './../util/session.js';\r\nimport ContactUs from \"./../components/Footer/ContactUs.js\";\r\nimport Disclaimer from \"./../components/Footer/Disclaimer.js\";\r\nimport PrivacyPolicy from \"./../components/Footer/PrivacyPolicy.js\";\r\nimport ReactGA from 'react-ga';\r\nimport centerOpsRoutes from \"./../routes/centerOpsRoutes.js\";\r\nimport mobilizerRoutes from \"./../routes/mobilizer.js\";\r\nimport funderRoutes from \"./../routes/funderroutes.js\"; \r\nimport changePasswordRoutes from \"./../routes/changePasswordRoutes.js\";\r\nimport {fetchUserDetails} from \"./../util/api.js\";\r\nconst useStyles = makeStyles(styles);\r\nlet ps;\r\nexport default function Admin({ ...rest }) {\r\n\r\n  \r\nReactGA.initialize(process.env.REACT_APP_GOOGLE_ANALYTICS_ID);\r\nReactGA.set({\r\n  userId: UserContext.userid\r\n  // any data that is relevant to the user session\r\n  // that you would like to track with google analytics\r\n})\r\nReactGA.pageview(window.location.pathname + window.location.search);\r\n\r\n\r\n  const [routes, setRoutes] = useState(stanadrdroutes);\r\n  const [loaded, setLoaded] = useState(true);\r\n\r\n  const  sessionValidity = (props)=>{\r\n   isSessionValid();\r\n}\r\n\r\nsessionValidity();\r\nconst validateUserLastLoginDate =()=>{\r\n  fetchUserDetails(UserContext.userid).then((userDetailsJsonData)=>{\r\n    console.log(userDetailsJsonData)\r\n    let res = JSON.parse(userDetailsJsonData.data)\r\n    console.log(\"data>>>>>>>>\",res)\r\n    let preDate = res[0].passwordChangedDate\r\n    console.log(typeof preDate)\r\n    let date1= new Date(preDate)\r\n    console.log(date1)\r\n    let today = new Date();\r\n    \r\n    // console.log(today)\r\n    const datediff = Math.floor((Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()) - Date.UTC(date1.getFullYear(), date1.getMonth(), date1.getDate()) ) /(1000 * 60 * 60 * 24));\r\n    console.log(\">>>>>>>>>>>>>>\",datediff)\r\n    UserContext.lastPassowrdChangeDiff = datediff;\r\n    if(datediff>=90){\r\n      setRoutes(changePasswordRoutes);\r\n      setLoaded(false);\r\n    }\r\n    })\r\n}\r\n// (()=>{\r\n//   fetchUserDetails(UserContext.userid).then((userDetailsJsonData)=>{\r\n//     let res = JSON.parse(userDetailsJsonData.data)\r\n//     let preDate = res[0].passwordChangedDate\r\n//     console.log(typeof preDate)\r\n//     let date1= new Date(preDate)\r\n//     console.log(date1)\r\n//     let today = new Date();\r\n    \r\n//     // console.log(today)\r\n//     const datediff = Math.floor((Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()) - Date.UTC(date1.getFullYear(), date1.getMonth(), date1.getDate()) ) /(1000 * 60 * 60 * 24));\r\n//     console.log(\">>>>>>>>>>>>>>\",datediff)\r\n//     UserContext.lastPassowrdChangeDiff = datediff;\r\n//     if(datediff>=90){\r\n//       // setRoutes()\r\n//       // history.push('/dashboard/changepassword')\r\n//       // <ChangePassword />\r\n//       setRoutes(changePasswordRoutes);\r\n//       setLoaded(false);\r\n//     }\r\n//     })\r\n// })()\r\n\r\n if(UserContext.roleid === 3 && (loaded || UserContext.defaultRoleId)){\r\n  UserContext.defaultRoleId=\"\";\r\n    setRoutes( principalroutes);\r\n    setLoaded(false);\r\n  } \r\nelse if(UserContext.roleName === 'Change leader/Facilitator' && (loaded || UserContext.defaultRoleId)){\r\n  UserContext.defaultRoleId=\"\";\r\n    setRoutes(changeleaderroutes);\r\n    setLoaded(false);\r\n\r\n  } else if(UserContext.roleName === 'Center Manager' && (loaded || UserContext.defaultRoleId) ){\r\n   // defaultProgramId check is NOT required , hence commeted by Murali on 2nd Nov 2021\r\n// And also there is no accessor role, this role will be carried by Center Managers only\r\n   if(UserContext.defaultProgramId == 1 || UserContext.defaultProgramId == 9)\r\n   {\r\n    validateUserLastLoginDate();\r\n    UserContext.defaultRoleId=\"\";\r\n   setRoutes(nanoUniconRoutes);\r\n   setLoaded(false);\r\n    }\r\n    else{\r\n    validateUserLastLoginDate();\r\n    UserContext.defaultRoleId=\"\";\r\n       setRoutes(assessorRoutes);\r\n       setLoaded(false);\r\n    }\r\n    \r\n      \r\n     } \r\n\r\n  \r\n  else if(UserContext.roleName === 'Corporate Admin' && (loaded || UserContext.defaultRoleId)){\r\n    validateUserLastLoginDate();\r\n    UserContext.defaultRoleId=\"\";\r\n    setRoutes(corporateAdminRoutes);\r\n    setLoaded(false);\r\n  }\r\n  \r\n  else if(UserContext.roleName === 'Center Ops' && (loaded || UserContext.defaultRoleId)){\r\n    validateUserLastLoginDate();\r\n   \r\n    UserContext.defaultRoleId=\"\";\r\n    setRoutes(centerOpsRoutes);\r\n    setLoaded(false);\r\n  }\r\n  \r\n  else if(UserContext.roleid === 19 && (loaded || UserContext.defaultRoleId)){\r\n    UserContext.defaultRoleId=\"\";\r\n    setRoutes(mobilizerRoutes);\r\n    setLoaded(false);\r\n  }\r\n  \r\n\r\n else if(UserContext.roleid === 10 && (loaded || UserContext.defaultRoleId)){\r\n    UserContext.defaultRoleId=\"\";\r\n    setRoutes(funderRoutes);\r\n    setLoaded(false);\r\n  }\r\n  \r\n  \r\n  let displayRoutes1 = [];\r\n  let count=0;\r\n  let displayRoutes = (\r\n        routes.map((prop)=>{ \r\n        if (prop.status) {\r\n          displayRoutes1[count]=prop;\r\n          count++;\r\n        }\r\n      }) \r\n  );\r\n\r\n  let switchRoutes = (\r\n      <Switch>\r\n        {routes.map((prop, key) => {\r\n          if (prop.layout === \"/dashboard\") {\r\n            return (\r\n              <Route\r\n                path={prop.layout + prop.path}\r\n                component={prop.component}\r\n                key={key}\r\n              />\r\n            );\r\n          }\r\n          return null;\r\n        })}\r\n\r\n        <Route  path=\"/dashboard/ContactUs\">\r\n            <ContactUs />\r\n        </Route>\r\n        <Route  path=\"/dashboard/Disclaimer\">\r\n            <Disclaimer />\r\n        </Route>\r\n        <Route  path=\"/dashboard/privacypolicy\">\r\n            <PrivacyPolicy />\r\n        </Route>\r\n        <Redirect from=\"/dashboard\" to=\"/dashboard/dashboard\" />\r\n      </Switch>\r\n    );\r\n    \r\n\r\n\r\n\r\n    // styles\r\n    const classes = useStyles();\r\n    // ref to help us initialize PerfectScrollbar on windows devices\r\n    const mainPanel = React.createRef();\r\n    // states and functions\r\n\r\n    const [fixedClasses, setFixedClasses] = React.useState(\"dropdown show\");\r\n    const [mobileOpen, setMobileOpen] = React.useState(false);\r\n\r\n\r\n    const handleDrawerToggle = () => {\r\n      setMobileOpen(!mobileOpen);\r\n    };\r\n    const getRoute = () => {\r\n    return window.location.pathname !== \"/admin/maps\";\r\n    };\r\n    const resizeFunction = () => {\r\n    if (window.innerWidth >= 960) {\r\n        setMobileOpen(false);\r\n    }\r\n    };\r\n\r\n// initialize and destroy the PerfectScrollbar plugin\r\nReact.useEffect(() => {\r\n    if (navigator.platform.indexOf(\"Win\") > -1) {\r\n      ps = new PerfectScrollbar(mainPanel.current, {\r\n        suppressScrollX: true,\r\n        suppressScrollY: false\r\n      });\r\n      document.body.style.overflow = \"hidden\";\r\n    }\r\n    window.addEventListener(\"resize\", resizeFunction);\r\n    // Specify how to clean up after this effect:\r\n    return function cleanup() {\r\n      if (navigator.platform.indexOf(\"Win\") > -1) {\r\n        ps.destroy();\r\n      }\r\n      window.removeEventListener(\"resize\", resizeFunction);\r\n    };\r\n  }, [mainPanel]);\r\n\r\n    \r\n    return (\r\n      \r\n        <div className={classes.wrapper} id=\"popupContainer\">\r\n            <Sidebar\r\n                handleDrawerToggle={handleDrawerToggle}    \r\n                logo={logo}\r\n                logoText={\"\"}\r\n                routes={displayRoutes1}\r\n                open={mobileOpen}        \r\n                {...rest}\r\n            />\r\n        \r\n            <div className={classes.mainPanel} ref={mainPanel}>\r\n                <Navbar\r\n                    routes={routes}\r\n                    handleDrawerToggle={handleDrawerToggle}\r\n                    {...rest}\r\n                />\r\n                \r\n                <div className={classes.content} >  \r\n                    <div className={classes.container}>{switchRoutes}</div>                    \r\n                </div>\r\n                \r\n                <Footer /> \r\n                \r\n            </div>\r\n        \r\n\r\n           \r\n\r\n        </div>\r\n        \r\n        \r\n\r\n\r\n    );\r\n    \r\n\r\n\r\n\r\n\r\n\r\n}\r\n"]},"metadata":{},"sourceType":"module"}