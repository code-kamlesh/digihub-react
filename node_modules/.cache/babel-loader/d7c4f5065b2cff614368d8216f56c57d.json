{"ast":null,"code":"var _jsxFileName = \"D:\\\\Tata_Strive\\\\WebApplication\\\\digiHub\\\\trunk\\\\digiHubWeb\\\\src\\\\views\\\\Documents.js\";\nimport React from 'react';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport { DropzoneArea } from 'material-ui-dropzone';\nimport { SingleSelect } from \"react-select-material-ui\";\nimport { TextField, Button, Grid } from '@material-ui/core';\nimport { deleteDocumentById, fetchUserDocumentsByEngagementIdAndTypeOfDocument, fetchUserDocumentsByUserIdAndTypeOfDocument, uploadDocument } from './../util/api';\nimport Paper from '@material-ui/core/Paper';\nimport { serviceEndPoint } from './../util/serviceEndPoint';\nimport UserContext from '../components/GolbalContext';\nimport AlertDialog from './../util/AlertDialog';\nimport { fileTypeFromFile } from 'file-type';\nconst alertDialogOptions = {\n  message: ''\n};\nexport default class Documents extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.downloadDocuments = value => {\n      let formData = new FormData();\n      formData.append('data', '{\"token\" : \"\", \"action\" : \"downloadDocument\", \"data\" : [{\"basicDocId\":' + value + '}]}');\n      fetch(serviceEndPoint.documentServiceEndPoint, {\n        method: 'post',\n        headers: {\n          'Authorization': 'Bearer ' + UserContext.token\n        },\n        body: formData\n      }).then(response => response.json()).then(jsondata => {\n        let jsonobjects = JSON.parse(jsondata.data);\n        var url = serviceEndPoint.downloadDocument + jsonobjects[0].documentPath + \"\";\n        window.open(url, \"_blank\");\n      });\n    };\n\n    this.onFileChangeHandler = files => {\n      var header = \"\";\n      var blob = files[0]; // See step 1 above\n\n      var fileReader = new FileReader();\n\n      fileReader.onloadend = e => {\n        console.log(\"1112222211\");\n        var arr = new Uint8Array(e.target.result).subarray(0, 2);\n\n        for (var i = 0; i < arr.length; i++) {\n          header += arr[i].toString(16);\n        }\n\n        console.log(header); // Check the file signature against known MIME (Magic Number)types\n        // its allow png, jpg,jpeg and pdf only\n\n        if (header === \"8950\" || header === \"ffd8\" || header == \"2550\") {\n          console.log(\"111111\");\n          console.log(this.state); // this.state.file = files[0]\n          // this.state.errors = false\n\n          this.setState({\n            file: files[0]\n          });\n          this.setState({\n            errors: false\n          });\n        } else {\n          alert(\"Please upload valid file\");\n          console.log(this.state); // this.state.errors = true\n\n          this.setState({\n            errors: true\n          });\n          this.setState(\"error \");\n          return;\n        }\n      };\n\n      fileReader.readAsArrayBuffer(blob);\n    };\n\n    this.uploadDocuments = e => {\n      e.preventDefault();\n      var localThis = this;\n      this.state.documentType.map(function (documentType) {\n        localThis.uploadDocument(documentType);\n      });\n      this.setState({\n        documentNumber: ''\n      });\n      this.setState({\n        clearDropzoneArea: this.state.clearDropzoneArea + 1\n      }); // this.setState({typeOfDocument:null});\n\n      this.setState({\n        documentType: []\n      });\n    };\n\n    this.uploadDocument = documentType => {\n      //   e.preventDefault();\n      // var genericDocuments=[\"8thCertificate\",\"10thCertificate\",\"12thCertificate\",\"StudentPicture\",\"PostGraduation\",\"Graduation\"];\n      var levelOfDocument = \"G\"; // if(genericDocuments.includes(this.state.typeOfDocument)){levelOfDocument=\"G\";}\n\n      let localThis = this;\n      let reader = new FileReader();\n      reader.readAsDataURL(this.state.file);\n\n      reader.onload = function () {\n        let document = reader.result;\n        localThis.setState({\n          alertDialogFlag: false\n        });\n        uploadDocument(localThis.state.dbUserId, localThis.state.engagementId, documentType, levelOfDocument, localThis.state.typeOfDocument, document, localThis.state.documentNumber).then(jsondata => {\n          alertDialogOptions.message = /*#__PURE__*/React.createElement(\"span\", {\n            style: {\n              color: \"green\"\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 34\n            }\n          }, documentType, \" File uploaded successfully\");\n          localThis.setState({\n            alertDialogFlag: true\n          });\n          localThis.getDocuments();\n        }); // .then(res => {\n        //   if(res.ok) {\n        //     alertDialogOptions.message=<span style={{color:\"green\"}}>{documentType} File uploaded successfully</span>;\n        //     localThis.setState({alertDialogFlag:true});\n        //     localThis.getDocuments();\n        //     }\n        // });\n      };\n    };\n\n    this.deleteDocument = basicDocId => {\n      deleteDocumentById(basicDocId).then(jsondata => {\n        this.getDocuments();\n      });\n    };\n\n    this.state = {\n      errors: false,\n      typeOfProof: [],\n      typeOfDocument: null,\n      typeOfProofData: [{\n        value: 'AgeProof',\n        label: 'Age Proof'\n      }, {\n        value: 'ApplicationForm',\n        label: 'Application Form'\n      }, {\n        value: 'AddressProof',\n        label: 'Address Proof'\n      }, {\n        value: 'CasteCertificate',\n        label: 'Caste Certificate'\n      }, {\n        value: 'ContributionReceipt',\n        label: 'Contribution Receipt'\n      }, {\n        value: 'EducationProof',\n        label: 'Education Proof'\n      }, {\n        value: 'FirstDayPicture',\n        label: 'First Day Picture'\n      }, {\n        value: 'IdentificationProof',\n        label: 'Identification Proof'\n      }, {\n        value: 'IncomeProof',\n        label: 'Income Proof'\n      }, {\n        value: 'LastDayPicture',\n        label: 'Last Day Picture'\n      }, {\n        value: 'Loanconsent',\n        label: 'Loan Consent from Student'\n      }, {\n        value: 'Medicalfitnesscertificate',\n        label: 'Medical fitness certificate'\n      }, {\n        value: 'PhotoProof',\n        label: 'Photo Proof'\n      }, {\n        value: 'StudentPicture',\n        label: 'Student Picture'\n      }, {\n        value: 'Studentsigned',\n        label: 'Student signed'\n      }],\n      typeOfDocumentData: [{\n        value: '8thCertificate',\n        label: '8th Certificate'\n      }, {\n        value: '10thCertificate',\n        label: '10th Certificate'\n      }, {\n        value: '12thCertificate',\n        label: '12th Certificate'\n      }, {\n        value: 'AadharCard',\n        label: 'Aadhar Card'\n      }, {\n        value: 'ApplicationForm',\n        label: 'Application Form'\n      }, {\n        value: 'BankStatement',\n        label: 'Bank Statement'\n      }, {\n        value: 'BirthCertificate',\n        label: 'Birth Certificate'\n      }, {\n        value: 'BPLCard',\n        label: 'BPL Card'\n      }, {\n        value: 'CasteCertificate',\n        label: 'Caste certificate'\n      }, {\n        value: 'ContributionReceipt',\n        label: 'Contribution Receipt'\n      }, {\n        value: 'DrivingLicense',\n        label: 'Driving License'\n      }, {\n        value: 'DiplomaCertificate',\n        label: 'Diploma Certificate'\n      }, {\n        value: 'ElectricityBill',\n        label: 'Electricity Bill'\n      }, {\n        value: 'FatherAadharCard',\n        label: 'Father Aadhar Card'\n      }, {\n        value: 'FirstDayPicture',\n        label: 'First Day Picture'\n      }, {\n        value: 'Graduation',\n        label: 'Graduation'\n      }, {\n        value: 'gaurdianAadharcard',\n        label: 'Gaurdian Aadhar card'\n      }, {\n        value: 'incomeCertificate',\n        label: 'Income Certificate'\n      }, {\n        value: 'LastDayPicture',\n        label: 'Last Day Picture'\n      }, {\n        value: 'Loanconsent',\n        label: 'Loan Consent from Student'\n      }, {\n        value: 'MedicalFitnessCertificate',\n        label: 'Medical Fitness Certificate'\n      }, {\n        value: 'MotherAadharCard',\n        label: 'Mother Aadhar Card'\n      }, {\n        value: 'NaregaCard',\n        label: 'Narega Card'\n      }, {\n        value: 'PanCard',\n        label: 'Pan Card'\n      }, {\n        value: 'Passport',\n        label: 'Passport'\n      }, {\n        value: 'PostGraduation',\n        label: 'Post Graduation'\n      }, {\n        value: 'RationCard',\n        label: 'Ration Card'\n      }, {\n        value: 'salarycertificate',\n        label: 'Salary Certificate'\n      }, {\n        value: 'SalarySlip',\n        label: 'Salary Slip'\n      }, {\n        value: 'SpouseAadharCard',\n        label: 'Spouse Aadhar Card'\n      }, {\n        value: 'StudentSigned',\n        label: 'Student Signed'\n      }, {\n        value: 'StudentPicture',\n        label: 'Student Picture'\n      }, {\n        value: 'TelephoneBill',\n        label: 'Telephone Bill'\n      }, {\n        value: 'VoterId',\n        label: 'Voter Id'\n      }],\n      documents: [],\n      engagementId: 0,\n      documentNumber: 0,\n      file: null,\n      fileName: '',\n      alertDialogFlag: false,\n      dbUserId: '',\n      documentType: [],\n      clearDropzoneArea: 0\n    };\n\n    if (props.id != null && props.id != undefined) {\n      this.state.dbUserId = props.id;\n      this.state.engagementId = props.engagementId;\n    }\n\n    this.getDocuments();\n  }\n\n  getDocuments() {\n    fetchUserDocumentsByUserIdAndTypeOfDocument(this.state.dbUserId, 'G').then(jsondata => {\n      let jsonobjects = JSON.parse(jsondata.data); // this.setState({documents: [...this.state.documents,...jsonobjects]}) \n\n      this.setState({\n        documents: jsonobjects\n      });\n    });\n  }\n\n  handleInputChange(event) {\n    const target = event.target;\n    const value = target.value;\n    const name = target.name;\n    this.setState({\n      [name]: value\n    });\n  }\n\n  handleSelectChange(selectname, event) {\n    this.setState({\n      [selectname]: event\n    });\n  }\n\n  handleTypeOfProofSelectChange(selectname, event) {\n    let newVal = event;\n    let stateVal = this.state.documentType;\n    stateVal.indexOf(newVal) === -1 ? stateVal.push(newVal) : stateVal.length === 1 ? stateVal = [] : stateVal.splice(stateVal.indexOf(newVal), 1);\n    this.setState({\n      documentType: stateVal\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Table, {\n      \"aria-label\": \"simple table\",\n      style: {\n        width: \"100%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 1\n      }\n    }, /*#__PURE__*/React.createElement(TableHead, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(TableRow, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(TableCell, {\n      style: {\n        width: \"15%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 13\n      }\n    }, \"Type of Document\"), /*#__PURE__*/React.createElement(TableCell, {\n      style: {\n        width: \"15%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 13\n      }\n    }, \"Type of Proof\"))), /*#__PURE__*/React.createElement(TableBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(TableRow, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(TableCell, {\n      style: {\n        width: \"15%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(SingleSelect, {\n      isClearable: true,\n      name: \"typeOfDocument\",\n      id: \"typeOfDocument\",\n      options: this.state.typeOfDocumentData,\n      onChange: this.handleSelectChange.bind(this, 'typeOfDocument'),\n      value: this.state.typeOfDocument || '',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(TableCell, {\n      style: {\n        width: \"15%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(SingleSelect, {\n      name: \"typeOfProof\",\n      id: \"typeOfProof\",\n      options: this.state.typeOfProofData,\n      onChange: this.handleTypeOfProofSelectChange.bind(this, 'documentType'),\n      value: this.state.documentType || '',\n      SelectProps: {\n        multi: true\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 13\n      }\n    }))), /*#__PURE__*/React.createElement(TableRow, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(DropzoneArea, {\n      name: \"file\",\n      id: \"file\",\n      meta: true,\n      maxFileSize: 2000000,\n      filesLimit: 1,\n      showFileNames: true,\n      onChange: this.onFileChangeHandler,\n      key: this.state.clearDropzoneArea,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      style: {\n        color: \"red\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 15\n      }\n    }, \"Note-: Document size should not be greater than 2mb.\"))))), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 1\n      }\n    }), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.uploadDocuments,\n      method: \"post\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 308,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Grid, {\n      container: true,\n      direction: \"row\",\n      justify: \"flex-end\",\n      alignItems: \"flex-end\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      type: \"submit\",\n      variant: \"contained\",\n      color: \"primary\",\n      size: \"small\",\n      disabled: this.state.errors == true || this.state.file == null || this.state.typeOfDocument == '' || this.state.documentType == '' ? true : false,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 14\n      }\n    }, \"Upload Document\"))), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 1\n      }\n    }), this.state.documents != \"\" && /*#__PURE__*/React.createElement(Paper, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 1\n      }\n    }, /*#__PURE__*/React.createElement(Table, {\n      \"aria-label\": \"simple table\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(TableHead, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(TableRow, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 11\n      }\n    }, \"Created On\"), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 11\n      }\n    }, \"Document Name\"), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 11\n      }\n    }, \"File Name\"), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 11\n      }\n    }, \"Download\"), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 11\n      }\n    }, \"Delete\"))), /*#__PURE__*/React.createElement(TableBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 9\n      }\n    }, this.state.documents.map(row => /*#__PURE__*/React.createElement(TableRow, {\n      key: row.basicDocId,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 15\n      }\n    }, row.createdOn), /*#__PURE__*/React.createElement(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 15\n      }\n    }, row.documentName), /*#__PURE__*/React.createElement(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 15\n      }\n    }, row.documentPath.split(\"/\")[1]), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      size: \"small\",\n      name: \"download\",\n      id: \"download\",\n      onClick: this.downloadDocuments.bind(this, row.basicDocId),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 15\n      }\n    }, \"Download\")), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      size: \"small\",\n      name: \"delete\",\n      id: \"delete\",\n      onClick: this.deleteDocument.bind(this, row.basicDocId),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 15\n      }\n    }, \"Delete\"))))))), this.state.alertDialogFlag && /*#__PURE__*/React.createElement(AlertDialog, {\n      message: alertDialogOptions.message,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 35\n      }\n    }));\n  }\n\n}","map":{"version":3,"sources":["D:/Tata_Strive/WebApplication/digiHub/trunk/digiHubWeb/src/views/Documents.js"],"names":["React","Table","TableBody","TableCell","TableHead","TableRow","DropzoneArea","SingleSelect","TextField","Button","Grid","deleteDocumentById","fetchUserDocumentsByEngagementIdAndTypeOfDocument","fetchUserDocumentsByUserIdAndTypeOfDocument","uploadDocument","Paper","serviceEndPoint","UserContext","AlertDialog","fileTypeFromFile","alertDialogOptions","message","Documents","Component","constructor","props","downloadDocuments","value","formData","FormData","append","fetch","documentServiceEndPoint","method","headers","token","body","then","response","json","jsondata","jsonobjects","JSON","parse","data","url","downloadDocument","documentPath","window","open","onFileChangeHandler","files","header","blob","fileReader","FileReader","onloadend","e","console","log","arr","Uint8Array","target","result","subarray","i","length","toString","state","setState","file","errors","alert","readAsArrayBuffer","uploadDocuments","preventDefault","localThis","documentType","map","documentNumber","clearDropzoneArea","levelOfDocument","reader","readAsDataURL","onload","document","alertDialogFlag","dbUserId","engagementId","typeOfDocument","color","getDocuments","deleteDocument","basicDocId","typeOfProof","typeOfProofData","label","typeOfDocumentData","documents","fileName","id","undefined","handleInputChange","event","name","handleSelectChange","selectname","handleTypeOfProofSelectChange","newVal","stateVal","indexOf","push","splice","render","width","bind","multi","row","createdOn","documentName","split"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport {DropzoneArea} from 'material-ui-dropzone';\r\nimport { SingleSelect } from \"react-select-material-ui\";\r\nimport {TextField,Button,Grid}  from '@material-ui/core';\r\nimport {deleteDocumentById,fetchUserDocumentsByEngagementIdAndTypeOfDocument,fetchUserDocumentsByUserIdAndTypeOfDocument,\r\n  uploadDocument} from './../util/api';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport { serviceEndPoint } from './../util/serviceEndPoint';\r\nimport UserContext from '../components/GolbalContext'\r\nimport AlertDialog from './../util/AlertDialog';\r\nimport {fileTypeFromFile} from 'file-type';\r\nconst alertDialogOptions = {\r\n  message: ''\r\n}\r\n\r\nexport default class Documents extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n         errors:false,\r\n          typeOfProof:[],typeOfDocument:null,\r\n        typeOfProofData:[ \r\n        { value: 'AgeProof', label: 'Age Proof' },\r\n        { value: 'ApplicationForm', label: 'Application Form' },\r\n\t\t{ value: 'AddressProof', label: 'Address Proof' },\r\n        { value: 'CasteCertificate', label: 'Caste Certificate' },\r\n        { value: 'ContributionReceipt', label: 'Contribution Receipt' },\r\n        { value: 'EducationProof', label: 'Education Proof' },\r\n\t\t{ value: 'FirstDayPicture', label: 'First Day Picture' },\r\n\t\t{ value: 'IdentificationProof', label: 'Identification Proof' },\r\n\t\t{ value: 'IncomeProof', label: 'Income Proof' },\r\n        { value: 'LastDayPicture', label: 'Last Day Picture' },\r\n\t\t{ value: 'Loanconsent', label: 'Loan Consent from Student' },\r\n        { value: 'Medicalfitnesscertificate', label: 'Medical fitness certificate' },\r\n        { value: 'PhotoProof', label: 'Photo Proof' },\r\n        { value: 'StudentPicture', label: 'Student Picture' },\r\n        { value: 'Studentsigned', label: 'Student signed' }\r\n\r\n      ],\r\n      typeOfDocumentData:[ \r\n        { value: '8thCertificate', label: '8th Certificate' },\r\n        { value: '10thCertificate', label: '10th Certificate' },\r\n        { value: '12thCertificate', label: '12th Certificate' },\r\n        { value: 'AadharCard', label: 'Aadhar Card' },\r\n        { value: 'ApplicationForm', label: 'Application Form' },\r\n        { value: 'BankStatement', label: 'Bank Statement' },\r\n        { value: 'BirthCertificate', label: 'Birth Certificate' },\r\n        { value: 'BPLCard', label: 'BPL Card' },\r\n        { value: 'CasteCertificate', label: 'Caste certificate' },\r\n        { value: 'ContributionReceipt', label: 'Contribution Receipt' },\r\n        { value: 'DrivingLicense', label: 'Driving License' },\r\n        { value: 'DiplomaCertificate', label: 'Diploma Certificate' },\r\n\t\t{ value: 'ElectricityBill', label: 'Electricity Bill' },\r\n        { value: 'FatherAadharCard', label: 'Father Aadhar Card' },\r\n        { value: 'FirstDayPicture', label: 'First Day Picture' },\r\n        { value: 'Graduation', label: 'Graduation' },\r\n\t\t{ value: 'gaurdianAadharcard', label: 'Gaurdian Aadhar card' },\r\n\t\t{ value: 'incomeCertificate', label: 'Income Certificate' },\r\n        { value: 'LastDayPicture', label: 'Last Day Picture' },\r\n\t\t{ value: 'Loanconsent', label: 'Loan Consent from Student' },\r\n        { value: 'MedicalFitnessCertificate', label: 'Medical Fitness Certificate' },\r\n        { value: 'MotherAadharCard', label: 'Mother Aadhar Card' },\r\n        { value: 'NaregaCard', label: 'Narega Card' },\r\n        { value: 'PanCard', label: 'Pan Card' },\r\n        { value: 'Passport', label: 'Passport' },\r\n        { value: 'PostGraduation', label: 'Post Graduation' },\r\n        { value: 'RationCard', label: 'Ration Card' },\r\n\t\t{ value: 'salarycertificate', label: 'Salary Certificate' },\r\n        { value: 'SalarySlip', label: 'Salary Slip' },\r\n        { value: 'SpouseAadharCard', label: 'Spouse Aadhar Card' },\r\n        { value: 'StudentSigned', label: 'Student Signed' },\r\n        { value: 'StudentPicture', label: 'Student Picture' },\r\n\t\t{ value: 'TelephoneBill', label: 'Telephone Bill' },\r\n        { value: 'VoterId', label: 'Voter Id' }   \r\n      ],\r\n       documents:[], engagementId : 0,documentNumber:0,file:null,fileName:'',alertDialogFlag:false,\r\n       dbUserId:'',documentType:[],clearDropzoneArea:0};\r\n\r\n\r\n       \r\nif(props.id != null && props.id != undefined)\r\n{\r\n  this.state.dbUserId=props.id;\r\n   this.state.engagementId=props.engagementId;\r\n}\r\n\r\nthis.getDocuments();\r\n\r\n}\r\n\r\n\r\ngetDocuments(){\r\n\r\nfetchUserDocumentsByUserIdAndTypeOfDocument(this.state.dbUserId,'G').then((jsondata) => {   \r\nlet jsonobjects = JSON.parse(jsondata.data);          \r\n// this.setState({documents: [...this.state.documents,...jsonobjects]}) \r\nthis.setState({documents:jsonobjects});    \r\n});\r\n\r\n}\r\n\r\n    \r\n    downloadDocuments = (value) => \r\n    {\r\n    let formData = new FormData();\r\n      formData.append('data', '{\"token\" : \"\", \"action\" : \"downloadDocument\", \"data\" : [{\"basicDocId\":'+value+'}]}');\r\n      fetch(serviceEndPoint.documentServiceEndPoint, {\r\n          method: 'post',\r\n          headers: {\r\n            'Authorization': 'Bearer '+UserContext.token\r\n        }, \r\n          body: formData\r\n      }).then(response => response.json()).then((jsondata)=>{\r\n        let jsonobjects = JSON.parse(jsondata.data);\r\n        var url=serviceEndPoint.downloadDocument+jsonobjects[0].documentPath+\"\"; \r\n        window.open(url, \"_blank\");\r\n       \r\n    \r\n      });\r\n      }\r\n\r\n      // Checking mime type\r\n onFileChangeHandler = ( files) => {\r\n    var header = \"\";\r\n    var blob = files[0]; // See step 1 above\r\n    var fileReader = new FileReader();\r\n     fileReader.onloadend =(e)=> {\r\n      console.log(\"1112222211\")\r\n      var arr = (new Uint8Array(e.target.result)).subarray(0, 2);\r\n     \r\n      for(var i = 0; i < arr.length; i++) {\r\n         header += arr[i].toString(16);\r\n      }\r\n      console.log(header);\r\n      \r\n      // Check the file signature against known MIME (Magic Number)types\r\n      // its allow png, jpg,jpeg and pdf only\r\n      if(header === \"8950\" ||header === \"ffd8\" || header == \"2550\")\r\n      {\r\n        console.log(\"111111\")\r\n        console.log(this.state)\r\n        // this.state.file = files[0]\r\n        // this.state.errors = false\r\n        this.setState({file: files[0]});\r\n        this.setState({errors : false})\r\n      }\r\n      else{\r\n        alert(\"Please upload valid file\")\r\n        console.log(this.state)\r\n        // this.state.errors = true\r\n        this.setState({errors : true})\r\n        this.setState(\"error \")\r\n        return; \r\n      }\r\n    };\r\n    fileReader.readAsArrayBuffer(blob);\r\n\r\n  }\r\n\r\n  uploadDocuments = (e) => {\r\n    e.preventDefault();\r\n    var localThis=this;\r\n   this.state.documentType.map(function(documentType){\r\n    localThis.uploadDocument(documentType);\r\n  });\r\n\r\n  this.setState({documentNumber:''});\r\n  this.setState({clearDropzoneArea: this.state.clearDropzoneArea + 1});\r\n // this.setState({typeOfDocument:null});\r\n  this.setState({ documentType:[]});\r\n    \r\n  }\r\n\r\n  uploadDocument = (documentType) => {\r\n //   e.preventDefault();\r\n// var genericDocuments=[\"8thCertificate\",\"10thCertificate\",\"12thCertificate\",\"StudentPicture\",\"PostGraduation\",\"Graduation\"];\r\nvar levelOfDocument=\"G\";\r\n// if(genericDocuments.includes(this.state.typeOfDocument)){levelOfDocument=\"G\";}\r\n\r\n\r\nlet localThis=this;\r\n\r\nlet reader = new FileReader();\r\nreader.readAsDataURL(this.state.file);\r\nreader.onload = function () {\r\nlet  document = reader.result;\r\n\r\nlocalThis.setState({alertDialogFlag:false});\r\nuploadDocument(localThis.state.dbUserId,localThis.state.engagementId,documentType,levelOfDocument,localThis.state.typeOfDocument,document,localThis.state.documentNumber)\r\n.then((jsondata) => {\r\n      alertDialogOptions.message=<span style={{color:\"green\"}}>{documentType} File uploaded successfully</span>;\r\n      localThis.setState({alertDialogFlag:true});\r\n      localThis.getDocuments();\r\n   })\r\n  // .then(res => {\r\n  //   if(res.ok) {\r\n  //     alertDialogOptions.message=<span style={{color:\"green\"}}>{documentType} File uploaded successfully</span>;\r\n  //     localThis.setState({alertDialogFlag:true});\r\n  //     localThis.getDocuments();\r\n  //     }\r\n  // });\r\n}\r\n  }\r\n\r\n  \r\n  handleInputChange(event) {\r\n    const target = event.target;\r\n    const value = target.value;\r\n    const name = target.name;\r\n    this.setState({[name]: value});\r\n   \r\n  }\r\n\r\n  handleSelectChange(selectname, event) {\r\n   this.setState({[selectname]: event}); \r\n  }\r\n\r\n\r\n  handleTypeOfProofSelectChange(selectname, event) {\r\n\r\n    let newVal = event;\r\n    let stateVal = this.state.documentType;\r\n\r\n    stateVal.indexOf(newVal) === -1\r\n      ? stateVal.push(newVal)\r\n      : stateVal.length === 1\r\n        ? (stateVal = [])\r\n        : stateVal.splice(stateVal.indexOf(newVal), 1)\r\n\r\n        this.setState({ documentType: stateVal });\r\n       \r\n   }\r\n \r\n  \r\n  deleteDocument = (basicDocId) => {\r\n  deleteDocumentById(basicDocId).then((jsondata) => {\r\n    this.getDocuments();\r\n });\r\n  \r\n}\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n\r\n\r\n<Table  aria-label=\"simple table\" style={{ width:\"100%\"}}>\r\n        <TableHead>\r\n          <TableRow>\r\n            <TableCell style={{ width:\"15%\"}}>Type of Document</TableCell>\r\n            <TableCell style={{ width:\"15%\"}}>Type of Proof</TableCell>\r\n            {/* <TableCell style={{ width:\"15%\"}}>Browse and Upload</TableCell> */}\r\n          </TableRow>\r\n        </TableHead>\r\n        <TableBody>\r\n            <TableRow >               \r\n            <TableCell  style={{ width:\"15%\"}}>  \r\n          \r\n            <SingleSelect  isClearable={true} \r\n               name=\"typeOfDocument\" id=\"typeOfDocument\"\r\n              options={this.state.typeOfDocumentData}\r\n              onChange={this.handleSelectChange.bind(this, 'typeOfDocument')}\r\n              value={this.state.typeOfDocument || ''}\r\n            />          \r\n            </TableCell>\r\n            <TableCell  style={{ width:\"15%\"}}>   \r\n            <SingleSelect  \r\n              name=\"typeOfProof\" id=\"typeOfProof\"\r\n              options={this.state.typeOfProofData}\r\n              onChange={this.handleTypeOfProofSelectChange.bind(this, 'documentType')}\r\n              value={this.state.documentType || ''}\r\n              SelectProps={{\r\n              multi:true\r\n              }}\r\n            \r\n            />\r\n            </TableCell>\r\n            {/* <TableCell >  \r\n            <TextField   type=\"text\" name=\"documentNumber\" id=\"documentNumber\"\r\n            label = \"Document Number\" onChange={this.handleInputChange.bind(this)}\r\n            value={this.state.documentNumber || ''}\r\n\r\n             />\r\n     \r\n            </TableCell> */}\r\n            </TableRow>            \r\n            <TableRow>\r\n            <TableCell>   \r\n            <DropzoneArea  \r\n              name=\"file\" id=\"file\"\r\n              meta\r\n              maxFileSize={2000000} filesLimit={1} showFileNames={true} \r\n              onChange={this.onFileChangeHandler}\r\n              key={this.state.clearDropzoneArea}\r\n              />\r\n              <p  style={{color:\"red\"}}>Note-: Document size should not be greater than 2mb.</p>\r\n            </TableCell>\r\n            </TableRow>\r\n        </TableBody>\r\n      </Table>\r\n<br/>\r\n\r\n      <form onSubmit={this.uploadDocuments} method=\"post\">\r\n      <Grid container direction=\"row\" justify=\"flex-end\" alignItems=\"flex-end\">\r\n             <Button type=\"submit\" variant=\"contained\" color=\"primary\" size=\"small\" \r\n                    disabled={this.state.errors== true || this.state.file==null || this.state.typeOfDocument=='' || this.state.documentType==''?true:false}\r\n             >Upload Document</Button>\r\n             </Grid>\r\n\r\n</form>\r\n<br/>\r\n\r\n      { \r\n  (this.state.documents!=\"\") &&\r\n\r\n<Paper>\r\n      <Table  aria-label=\"simple table\">\r\n        <TableHead>\r\n          <TableRow>\r\n          <TableCell>Created On</TableCell>\r\n          <TableCell>Document Name</TableCell>\r\n          <TableCell>File Name</TableCell>\r\n          <TableCell >Download</TableCell>\r\n          <TableCell >Delete</TableCell>\r\n          </TableRow>\r\n        </TableHead>\r\n        <TableBody>\r\n          {this.state.documents.map(row => (\r\n            <TableRow key={row.basicDocId}>\r\n              <TableCell component=\"th\" scope=\"row\">\r\n          \r\n                {row.createdOn}\r\n              </TableCell>\r\n              <TableCell component=\"th\" scope=\"row\">\r\n                {row.documentName}\r\n              </TableCell>\r\n              <TableCell component=\"th\" scope=\"row\">\r\n                {row.documentPath.split(\"/\")[1]}\r\n              </TableCell>\r\n            <TableCell >                 \r\n              <Button variant=\"contained\" color=\"primary\" size=\"small\" name=\"download\" id=\"download\" \r\n             \r\n               onClick={this.downloadDocuments.bind(this,row.basicDocId)}\r\n              >Download</Button>\r\n            </TableCell>            \r\n\r\n            <TableCell >                 \r\n              <Button variant=\"contained\" color=\"primary\" size=\"small\" name=\"delete\" id=\"delete\" \r\n               onClick={this.deleteDocument.bind(this,row.basicDocId)}\r\n              >Delete</Button>\r\n            </TableCell>            \r\n\r\n\r\n            </TableRow>\r\n          ))}\r\n        </TableBody>\r\n      </Table>\r\n    </Paper>\r\n\r\n\r\n          }\r\n                   { \r\n  (this.state.alertDialogFlag) && <AlertDialog   message={alertDialogOptions.message}></AlertDialog>\r\n    }\r\n \r\n\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}